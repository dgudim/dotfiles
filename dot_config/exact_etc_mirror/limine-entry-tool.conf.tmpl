### Note: Editing this configuration file is not necessary. Instead, copy it to `/etc/default/limine` and configure it as needed.
### Settings in `/etc/default/limine` will override here.

### OS Entry Targeting
### If TARGET_OS_NAME is not set, or if the default distro name is not found in $ESP_PATH/limine.conf,
### the tool will create a new OS entry using the default distro name (PRETTY_NAME or NAME from /etc/os-release) and machine-ID.
###
### Tips:
### If your custom OS entry already exists in $ESP_PATH/limine.conf, please add "comment: machine-id=<copy ID from /etc/machine-id>" to it.
### The machine-ID helps the tool to automatically target the correct OS entry, so changing the OS name does not matter.
###
#TARGET_OS_NAME="Arch Linux"

### Skip UEFI Check and Registration
### Skip UEFI check and bootloader registration on certain non-compliant UEFI boards (e.g., some MSI boards) (yes|no)
### If skipped, Limine will be used as the fallback bootloader on the standard UEFI path for all UEFI systems.
### Note:
### When set to yes, run 'limine-install' and manually set the BIOS boot order to make the standard UEFI path the default boot.
{{- if eq .chezmoi.hostname "portable-heater" }}
# Don't registed efi when booted from portable drive
NO_EFI_REGISTER=1
SKIP_UEFI=yes
{{- end }}


### Boot Partition Path
### Specify the mount path of your boot partition if you are running on legacy BIOS, ARM, or RISC-V.
### Note:
### If you are using systemd with UEFI, the path is detected automatically via 'bootctl --print-esp-path'.
### If detection fails, set this path manually.
#ESP_PATH="/boot"


### Kernel Command Line Configuration
### Define one or more kernel command lines (parameters) for specific kernel entries.
### If unset, the tool will try to read them from '/etc/kernel/cmdline' or '/proc/cmdline'.
###
### Rules:
### * KERNEL_CMDLINE[default] applies to any kernel entries without specific configuration.
### * KERNEL_CMDLINE[fallback] applies to kernel entries with names containing *fallback*
### * KERNEL_CMDLINE[kernel name] applies to a specific kernel entry.
###
### Operators:
### * `+=` appends parameters to an existing cmdline for the same KERNEL_CMDLINE[<key>]
###    Commonly used in drop-in configs: /etc/limine-entry-tool.d/*.conf
###    Ignores /etc/kernel/cmdline and /proc/cmdline
### * `=` replaces an existing cmdline for the same KERNEL_CMDLINE[<key>]
###    Note: /etc/default/limine overrides any drop-in configs, so `+=` is recommended in that file.
###
### Tip:
### If unsure which parameters to use, copy them from `/proc/cmdline` into KERNEL_CMDLINE[default],
### but ensure your system is not a live ISO, temporary environment, or snapshot.
###
### Examples:
#KERNEL_CMDLINE[default]+="rw root=UUID=..."
#KERNEL_CMDLINE[default]+="quiet splash"
#KERNEL_CMDLINE[fallback]=
#KERNEL_CMDLINE[linux-zen]=

{{ if eq .chezmoi.hostname "black-bird" }}
KERNEL_CMDLINE[default]="nvme_load=YES nowatchdog rw mitigations=off zswap.enabled=1 zswap.compressor=lz4 zswap.max_pool_percent=20 rd.luks.uuid=1c5c824f-40e6-49f6-918c-8e09f46f731c root=/dev/mapper/luks-1c5c824f-40e6-49f6-918c-8e09f46f731c rootflags=subvol=/ rd.luks.uuid=16b658ff-614b-4cfb-a576-f284e9368530 quiet splash"
{{ else if eq .chezmoi.hostname "sauron" }}
KERNEL_CMDLINE[default]="nvme_load=YES nowatchdog rw mitigations=off zswap.enabled=1 zswap.compressor=lz4 zswap.max_pool_percent=20 amd_pstate=active root=UUID=aedf61ca-76c1-4522-bfac-9f534304292b resume=UUID=ec851086-4c72-42c4-a605-a6d1a8774413 drm.edid_firmware=DVI-D-1:edid/samsung-q800t-hdmi2.1 video=DVI-D-1:e"
{{ else if eq .chezmoi.hostname "nuclear-submarine" }}
KERNEL_CMDLINE[default]="nvme_load=YES nowatchdog rw mitigations=off zswap.enabled=1 zswap.compressor=lz4 zswap.max_pool_percent=20 amd_pstate=active root=UUID=e53e5317-0e09-42f1-8c1f-e64dfb96437e rootflags=subvol=@"
{{ else if eq .chezmoi.hostname "portable-heater" }}
KERNEL_CMDLINE[default]="nvme_load=YES nowatchdog rw mitigations=off zswap.enabled=1 zswap.compressor=lz4 zswap.max_pool_percent=20 rd.luks.uuid=3a5f817f-a019-4bd6-80f7-f3c163477c14 root=/dev/mapper/luks-3a5f817f-a019-4bd6-80f7-f3c163477c14"
{{ end }}


### Formatting Boot Entry
### Define the number of spaces to indent each line of the boot entry in '$ESP_PATH/limine.conf'.
### If not set, the default is 2.
SPACE_NUMBER=2


### Boot Integrity Check
### Enable BLAKE2 checksum verification for bootable files. (yes|no)
ENABLE_VERIFICATION=yes


### Automatic Config Backup
### Creates a backup of '$ESP_PATH/limine.conf' before saving any changes,
### but only if '$ESP_PATH/limine.conf.old' is older than the specified time (in hours).
### Default: 6 hours if unset.
CONFIG_BACKUP_THRESHOLD=8


### Kernel Entries Order
### Wildcard "*" matches any letter in kernel entry name
### If ENABLE_SORT is set to "yes", only wildcard "*" entries are sorted alphabetically.
BOOT_ORDER="*lts, *, *fallback, Snapshots"
ENABLE_SORT=no


### Default Boot Fallback
### Configure whether Limine should be installed as the default UEFI fallback loader. (yes|no|"")
### This helps preserve bootability on UEFI systems where BIOS, firmware, or Windows updates may remove custom Linux UEFI entries.
###
### Options:
### * "yes"               -> Always create, update, or overwrite the fallback on each limine-update.
### * "no"                -> Do nothing.
### * "" or commented out -> Create the fallback only if it is not present. If a fallback exists, leave it untouched.
###
### Note:
### With Secure Boot enabled, the default fallback is not signed automatically by limine-update for some reason.
### If you need to sign it, it is recommended to disable ENABLE_LIMINE_FALLBACK, run 'limine-install --fallback' once,
### and then sign the fallback manually.
###
#ENABLE_LIMINE_FALLBACK=""
{{- if eq .chezmoi.hostname "portable-heater" }}
ENABLE_LIMINE_FALLBACK=no
{{- else }}
ENABLE_LIMINE_FALLBACK=yes
{{- end }}


### Find Bootloaders
### Automatically add systemd-boot, rEFInd, or the default EFI loader to Limine if they are found in the ESP. (yes|no)
FIND_BOOTLOADERS=yes


### Quiet Mode
### Set to "yes" to hide all success messages and avoid log spam. (yes|no)
QUIET_MODE=yes


### Enroll Limine Config
### Automatically enrolls the Limine config '$ESP_PATH/limine.conf' into the Limine binary to protect it from modifications.
###
### WARNING and RISK:
### Enabling this will PREVENT booting if you modify limine.conf and forget to re-enroll it manually.
###
### If you are unsure but want to try it, set 'ENABLE_LIMINE_FALLBACK=yes' and run 'limine-update'.
### This allows you to boot into the Limine fallback if booting is blocked due to a config mismatch.
###
### IMPORTANT REMINDER:
### After editing limine.conf, always run 'limine-enroll-config', otherwise Limine will refuse to boot due to a config mismatch.
###
### Notes:
### * Remove all other alternative Limine configs in different locations to avoid boot failure.
### * If using limine-snapper-sync, set 'COMMANDS_BEFORE_SAVE=limine-reset-enroll' and 'COMMANDS_AFTER_SAVE=limine-enroll-config' to automate config enrollment.
### * If multiple systems share the same limine.conf, ensure each one handles enrollment automatically.
### * To enable, copy this option to /etc/default/limine and set it to (yes|no).
###
#ENABLE_ENROLL_LIMINE_CONFIG=no


##############  Below options apply to Arch Linux when 'limine-dracut-support' is installed ##############

### Dracut Fallback Configuration
### Automatically create a kernel fallback image using Dracut. (yes|no)
### If set to 'yes,' this will consume a lot of storage space, especially when taking multiple snapshots.
{{- if eq .chezmoi.hostname "portable-heater" }}
DRACUT_FALLBACK=yes
{{ else }}
DRACUT_FALLBACK=no
{{- end }}


### UKI (Unified Kernel Image)
### Automatically create UKIs in '$ESP_PATH/EFI/Linux/' using Dracut for UEFI. (yes|no)
###
### Advantage:
###  - UKIs are automatically loaded by bootloaders like 'systemd-boot' and 'rEFInd'.
### Disadvantage:
###  - UKIs use more ESP space compared to separate 'initramfs' and 'vmlinuz' files, especially with multiple Limine snapshots.
###
### Additional notes:
### - Duplicate 'initramfs' and 'vmlinuz' files are removed when 'limine-dracut' or 'limine-update' is run to generate a UKI.
### - UKI ignores booting into a snapshot when Secure Boot is enabled. To resolve this, any embedded kernel cmdline is removed from the UKI, which will then read the external kernel cmdline.
ENABLE_UKI=no


### Custom UKI Name
### Set a shorter, custom name for your UKI files instead of using the default machine-id.
### This can help when booting UKIs directly via EFISTUB (without any bootloader),
### since some buggy UEFI firmware (e.g. Asus AMI BIOS) may crash or freeze if UKI filenames are too long when registered in UEFI.
###
### Rules:
### * Custom name must be unique (like an ID) to avoid conflicts with other installations, otherwise UKIs will be overwritten.
### * Use only lowercase letters (a–z) and digits (0–9) for maximum compatibility with UEFI firmware and devices.
###
### Example: ${CUSTOM_UKI_NAME}_${kernel_version}.efi -> arch_linux-lts.efi (when CUSTOM_UKI_NAME="arch" is set)
### Default: The machine-id is used if the custom name is invalid or not set.
###
### WARNING:
### If you change the name, old UKI files with the previous prefix (name or ID) remain unused on the ESP;
### remove them manually to free up ESP space if not needed: $ESP_PATH/EFI/Linux/{machine-id or old name}_{kernel_version}.efi
#CUSTOM_UKI_NAME="arch"

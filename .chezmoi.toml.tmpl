{{- $fontsize := promptIntOnce . "konsole.fontsize" "Konsole font size" -}}
{{- $git_username := promptStringOnce . "git.git_username" "Git username" -}}
{{- $git_email := promptStringOnce . "git.git_email" "Git email" -}}

{{ $GIT_EMAIL_ENV := printf "%s=%s" "GIT_EMAIL" $git_email }}
{{ $signingkey := output "env" $GIT_EMAIL_ENV "sh" "-c" "gpg --with-colons --locate-keys $GIT_EMAIL | grep pub | cut -d : -f 5" | trim }}

[data.konsole]
    fontsize = {{ $fontsize }}

[data.git]
    git_username = {{ $git_username | quote }}
    git_email = {{ $git_email | quote }}

[data.gpg]
    signingkey = {{ $signingkey | quote }}

[git]
    autoCommit = false
    autoPush = false

encryption = "gpg"
progress=true

[gpg]
    recipient = {{ $git_email | quote }}

{{ if eq $signingkey "" }}
{{  writeToStdout "Warning, signing key for " }}
{{  writeToStdout $git_email }}
{{  writeToStdout " wasn't found\n" }}
{{ else }}
{{  writeToStdout "Inferred signing key: " }}
{{  writeToStdout $signingkey }}
{{  writeToStdout "\n" }}
{{ end }}
